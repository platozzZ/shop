(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesA/bargain/bargain"],{1838:function(t,a,o){},"1dcd":function(t,a,o){"use strict";(function(t){o("a1f9");i(o("66fd"));var a=i(o("2751"));function i(t){return t&&t.__esModule?t:{default:t}}t(a.default)}).call(this,o("543d")["createPage"])},2751:function(t,a,o){"use strict";o.r(a);var i=o("d166"),e=o("cd3f");for(var n in e)"default"!==n&&function(t){o.d(a,t,(function(){return e[t]}))}(n);o("e82f");var r,s=o("f0c5"),u=Object(s["a"])(e["default"],i["b"],i["c"],!1,null,"de35e596",null,!1,i["a"],r);a["default"]=u.exports},cd3f:function(t,a,o){"use strict";o.r(a);var i=o("dca9"),e=o.n(i);for(var n in i)"default"!==n&&function(t){o.d(a,t,(function(){return i[t]}))}(n);a["default"]=e.a},d166:function(t,a,o){"use strict";var i,e=function(){var t=this,a=t.$createElement;t._self._c},n=[];o.d(a,"b",(function(){return e})),o.d(a,"c",(function(){return n})),o.d(a,"a",(function(){return i}))},dca9:function(t,a,o){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;o("2f62");function i(t){return s(t)||r(t)||n(t)||e()}function e(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(t,a){if(t){if("string"===typeof t)return u(t,a);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(o):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?u(t,a):void 0}}function r(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function s(t){if(Array.isArray(t))return u(t)}function u(t,a){(null==a||a>t.length)&&(a=t.length);for(var o=0,i=new Array(a);o<a;o++)i[o]=t[o];return i}var d=function(){Promise.all([o.e("common/vendor"),o.e("components/header")]).then(function(){return resolve(o("6c1c"))}.bind(null,o)).catch(o.oe)},c=function(){o.e("components/uni-load-more").then(function(){return resolve(o("ef75"))}.bind(null,o)).catch(o.oe)},g=function(){o.e("components/toload").then(function(){return resolve(o("b4d3"))}.bind(null,o)).catch(o.oe)},l={data:function(){return{doodsreturn:0,timeid:0,groupList:[],title:"热门砍价",access_id:"",loadGif:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"/images/icon1/loading.gif",nobargainImg:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"/images/icon1/noFind.png",no_bargain:this.LaiKeTuiCommon.LKT_ROOT_VERSION_URL+"/images/icon1/no_bargain.png",brHeadImg:"",load:!1,topTabBar:!0,list:"",page1:1,page2:1,noBargain:!1,loadingType:0,daodi:!1,obj:{},isShow:!1,dialogContent:"",uniLoadMore:!1,hasorder:0}},onLoad:function(a){var o=this;a.topTabBar?(console.log("转发"),this.doodsreturn=6):(o.topTabBar=!1,t.setNavigationBarTitle({title:"我的砍价"}),o.title="我的砍价"),o.access_id=t.getStorageSync("access_id")},onShow:function(){var a=this;a.access_id=t.getStorageSync("access_id"),a.page1=1,a.page2=1;var o=new Promise((function(t,o){a.LaiKeTuiCommon.getLKTApiUrl().then((function(){t(1231)}))}));o.then((function(){a.$nextTick((function(){a.access_id=t.getStorageSync("access_id")?t.getStorageSync("access_id"):a.$store.state.access_id,a._axios()}))}))},methods:{_back:function(){this.topTabBar?t.switchTab({url:"../../pages/tabBar/home"}):t.switchTab({url:"../../pages/tabBar/my"})},changeLoginStatus:function(){var t=this;t.access_id=t.$store.state.access_id,t._axios()},toPay:function(a,o,i,e,n){var r=[];r.push({pid:a}),r.push({cid:o}),r.push({num:1}),r.push({bargain:!0}),r.push({bargain_id:n}),r.push({order_no:e}),r=JSON.stringify(r),t.navigateTo({url:"../../pages/pay/orderDetailsr?product="+r+"&bargain=true&bargain_id="+n+"&order_no="+e})},contBr:function(a,o,i,e,n){t.navigateTo({url:"bargainIng?proId="+a+"&attr_id="+o+"&brStatus="+i+"&order_no="+e+"&bargain_id="+n})},goGoods:function(a,o,i,e,n,r,s,u,d){this.$store.state.pro_id=a;var c=3;0==i?c=4:1==i?c=0:2==i?c=1:3==i&&(c=2),n<=0&&(c=3),n>0&&2==i&&s?t.navigateTo({url:"../../pages/goods/goodsDetailed?bargain=true&isbegin="+d+"&pro_id="+a+"&brStatus="+c+"&attr_id="+o+"&order_no="+e+"&leftTime="+n+"&bargain_id="+r+"&hasorder="+s+"&sNo_id="+u}):t.navigateTo({url:"../../pages/goods/goodsDetailed?bargain=true&pro_id="+a+"&brStatus="+c+"&attr_id="+o+"&order_no="+e+"&leftTime="+n+"&bargain_id="+r+"&isbegin="+d})},lodingPay:function(a){t.navigateTo({url:"../../pages/order/order?order_id="+a+"&showPay=true"})},setTimeData:function(){var t=this;if(0===t.groupList.length)return!1;for(var a=0;a<t.groupList.length;a++){var o=!0;if(t.topTabBar){var i=--t.groupList[a].leftTime;t.groupList[a].leftTime<0&&(o=!1)}else if(2==t.groupList[a].status){i=--t.groupList[a].canbuy;t.groupList[a].canbuy<=0&&(o=!1)}else{i=--t.groupList[a].leftTime;(t.groupList[a].leftTime<=0||3==t.groupList[a].status||-1==t.groupList[a].status)&&(o=!1)}if(o){var e=Math.floor(parseInt(i)/86400),n=Math.floor(i/3600-24*e),r=Math.floor((i-60*n*60-24*e*60*60)/60),s=i%60;n<10&&(n="0"+n),r<10&&(r="0"+r),s<10&&(s="0"+s),0==e&&(e="0"),t.groupList[a].hour=isNaN(n)?"00":n,t.groupList[a].mniuate=isNaN(n)?"00":r,t.groupList[a].second=isNaN(n)?"00":s,t.groupList[a].day=isNaN(n)?"00":e}else t.groupList[a].hour="00",t.groupList[a].mniuate="00",t.groupList[a].second="00",t.groupList[a].day="0"}0===t.timeid&&(t.timeid=setInterval((function(){for(var a=0;a<t.groupList.length;a++){var o=!0;if(t.topTabBar){var i=--t.groupList[a].leftTime;t.groupList[a].leftTime<0&&(o=!1)}else if(2==t.groupList[a].status){i=--t.groupList[a].canbuy;t.groupList[a].canbuy<=0&&(o=!1)}else{i=--t.groupList[a].leftTime;(t.groupList[a].leftTime<=0||3==t.groupList[a].status||-1==t.groupList[a].status)&&(o=!1)}if(o){var e=Math.floor(parseInt(i)/86400),n=Math.floor(i/3600-24*e),r=Math.floor((i-60*n*60-24*e*60*60)/60),s=i%60;n<10&&(n="0"+n),r<10&&(r="0"+r),s<10&&(s="0"+s),0==e&&(e="0"),t.groupList[a].hour=n,t.groupList[a].mniuate=r,t.groupList[a].second=s,t.groupList[a].day=e}else t.groupList[a].hour="00",t.groupList[a].mniuate="00",t.groupList[a].second="00",t.groupList[a].day="0"}}),1e3)),setTimeout((function(){t.list=t.groupList}),0)},closeDialog:function(){this.isShow=!1},clickConfirm:function(){var a=this;this.closeDialog(),t.navigateTo({url:"bargainIng?proId="+a.obj.proId+"&attr_id="+a.obj.attr_id+"&brStatus="+a.obj.brStatus+"&bargain_id="+a.obj.bargain_id+"&order_no="+a.obj.order_no+"&hasorder="+a.hasorder})},toBargainIng:function(a,o,i,e,n,r,s){if(!(s<=0)){var u=this,d={module:"app",action:"login",app:"token",access_id:this.access_id};t.request({url:t.getStorageSync("url"),data:d,success:function(d){if(200==d.data.code&&1===d.data.login_status)if(console.log(i+"---leftTime----"+s),0!=i&&s>0){var c={4:"砍价失败，是否查看详情？",0:"此商品砍价结束，是否查看详情？",1:"您已参与此商品的砍价活动，是否查看详情？",2:"您已完成砍价，是否查看详情？",3:"您已付款此商品，是否查看详情？"};u.obj={proId:a,attr_id:o,brStatus:i,order_no:e,bargain_id:n,hasorder:r},u.dialogContent=i<0?-1==i?c[0]:c[4]:c[i],u.isShow=!0}else 0==i&&t.navigateTo({url:"bargainIng?proId="+a+"&attr_id="+o+"&brStatus="+i+"&bargain_id="+n+"&order_no="+e});else u.$refs.lktAuthorizeComp.handleAfterAuth(u,"../../pages/login/login?landing_code=1")}})}},timeout:function(){t.showToast({title:"未登录，请先登录!",duration:1e3,icon:"none"}),setTimeout((function(){t.navigateTo({url:"../../pages/login/login?landing_code=1"})}),1e3)},changeTabBar:function(a){var o=this;o.$refs.lktAuthorizeComp.handleAfterAuth(o,"../../pages/login/login?landing_code=1",(function(){t.navigateTo({url:"/pagesA/bargain/bargain"})}))},_axios:function(){var a=this;a.groupList=[],a.loadingType=0,a.daodi=!1;var o={access_id:a.access_id,module:"app",action:"bargain"};this.topTabBar?(o.m="bargainhome",o.page=this.page1):(o.m="mybargain",o.page=this.page2),t.request({url:t.getStorageSync("url"),data:o,header:{"content-type":"application/x-www-form-urlencoded"},method:"POST",success:function(o){var e;(a.load=!0,200==o.data.code)?(a.uniLoadMore=!0,a.brHeadImg=o.data.img,a.list=o.data.list,console.log(a.list),(e=a.groupList).push.apply(e,i(o.data.list)),a.setTimeData(),a.noBargain=!o.data.list.length,o.data.list.length<10&&(a.loadingType=2,a.daodi=!0)):404==o.data.code?(a.topTabBar=!0,console.log("#########################")):(a.list=[],t.showToast({title:o.data.message,icon:"none",duration:1500}))}})}},onReachBottom:function(){var t=this;if(this.daodi)return!1;var a={access_id:this.access_id,module:"app",action:"bargain"};this.topTabBar?(a.m="bargainhome",a.page=++this.page1):(a.m="mybargain",a.page=++this.page2),this.loadingType=1,this.$req.post({data:a}).then((function(a){var o;200==a.code&&(a.list.length?(t.list=t.list.concat(a.list),(o=t.groupList).push.apply(o,i(a.list)),a.list.length<10&&(t.loadingType=2,t.topTabBar?t.page1=1:t.page2=1,t.daodi=!0)):t.loadingType=2)}))},computed:{halfWidth:function(){var a=t.getStorageSync("data_height")?t.getStorageSync("data_height"):this.$store.state.data_height,o=parseInt(a);o=0;var i=2*o;return t.upx2px(i)+"px"}},components:{uniLoadMore:c,heads:d,toload:g}};a.default=l}).call(this,o("543d")["default"])},e82f:function(t,a,o){"use strict";var i=o("1838"),e=o.n(i);e.a}},[["1dcd","common/runtime","common/vendor"]]]);